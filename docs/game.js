!function(t){var e={};function s(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(i,a,function(e){return t[e]}.bind(null,a));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);var i={};s.r(i),s.d(i,"Boot",function(){return r}),s.d(i,"Loading",function(){return h}),s.d(i,"Home",function(){return o}),s.d(i,"Main",function(){return c});const a="./",n="./";class r extends Phaser.Scene{constructor(){super("bootScene")}preload(){this.load.setBaseURL(a),this.load.setPath(n),this.load.image("logo","images/rubber_duck.png")}create(){console.log("into loadingScene..."),this.scene.start("loadingScene")}}class h extends Phaser.Scene{constructor(){super("loadingScene")}preload(){const t=this.sys.game.config.width,e=this.sys.game.config.height;this.add.sprite(.5*t,250,"logo"),this.load.setBaseURL(a),this.load.setPath(n);const s=this.add.graphics();s.setPosition(.5*t-75,.5*e-15),s.fillStyle(16119285,1),s.fillRect(0,0,150,30);const i=this.add.graphics();i.setPosition(.5*t-75,.5*e-15),this.load.on("progress",t=>{i.clear(),i.fillStyle(10148237,1),i.fillRect(0,0,150*t,30)}),this.load.image("backyard","images/backyard.png"),this.load.image("apple","images/apple.png"),this.load.image("candy","images/candy.png"),this.load.image("rotate","images/rotate.png"),this.load.image("toy","images/rubber_duck.png"),this.load.spritesheet("pet","images/pet.png",{frameWidth:97,frameHeight:83,margin:1,spacing:1})}create(){this.anims.create({key:"funnyfaces",frames:this.anims.generateFrameNames("pet",{frames:[1,2,3]}),frameRate:7,yoyo:!0,repeat:0}),this.scene.start("homeScene")}}class o extends Phaser.Scene{constructor(){super("homeScene")}create(){const t=this.add.sprite(0,0,"backyard").setInteractive().setOrigin(0,0),e=this.sys.game.config.width,s=this.sys.game.config.height,i=this.add.text(.5*e,.5*s," 开 始 游 戏",{font:"40px Arial",fill:"#ffffff"});i.setOrigin(.5,.5),i.setDepth(1);const a=this.add.graphics();a.fillStyle(0,.7),a.fillRect(.5*e-.5*i.width-10,.5*s-.5*i.height-10,i.width+20,i.height+20),t.on("pointerdown",()=>{this.scene.start("mainScene")})}}class c extends Phaser.Scene{constructor(){super("mainScene")}init(){this.stats={health:100,fun:100},this.decayRates={health:-5,fun:-2}}create(){this.add.sprite(0,0,"backyard").setInteractive().setOrigin(0,0).on("pointerdown",this.placeItem,this),this.pet=this.add.sprite(100,200,"pet",0).setInteractive(),this.pet.setDepth(1),this.input.setDraggable(this.pet),this.input.on("drag",(t,e,s,i)=>{e.x=s,e.y=i}),this.createUi(),this.createHud(),this.refreshHud(),this.time.addEvent({delay:1e3,repeat:-1,callback:()=>{this.updateStats(this.decayRates)}})}createUi(){this.appleSprite=this.add.sprite(72,570,"apple").setInteractive(),this.appleSprite.customStats={health:20,fun:0},this.appleSprite.on("pointerdown",this.pickItem),this.candySprite=this.add.sprite(144,570,"candy").setInteractive(),this.candySprite.customStats={health:-10,fun:10},this.candySprite.on("pointerdown",this.pickItem),this.toySprite=this.add.sprite(216,570,"toy").setInteractive(),this.toySprite.customStats={health:0,fun:15},this.toySprite.on("pointerdown",this.pickItem),this.rotateSprite=this.add.sprite(288,570,"rotate").setInteractive(),this.rotateSprite.customStats={fun:20},this.rotateSprite.on("pointerdown",this.rotatePet),this.sprites=[this.appleSprite,this.candySprite,this.toySprite,this.rotateSprite],this.uiReady()}rotatePet(){this.scene.uiBlocked||(this.scene.uiReady(),this.scene.uiBlocked=!0,this.setAlpha(.5),this.scene.tweens.add({targets:this.scene.pet,duration:600,angle:720,pause:!1,onComplete:(t,e)=>{this.scene.updateStats(this.customStats),this.scene.uiReady()}}))}pickItem(){this.scene.uiBlocked||(this.scene.uiReady(),this.scene.selectedItem=this,this.setAlpha(.5))}uiReady(){this.selectedItem=null;for(let t=0;t<this.sprites.length;t++)this.sprites[t].setAlpha(1);this.uiBlocked=!1}placeItem(t,e,s){if(!this.selectedItem)return;if(this.uiBlocked)return;const i=this.add.sprite(e,s,this.selectedItem.texture.key).setDepth(2);this.uiBlocked=!0;this.tweens.add({targets:this.pet,duration:500,x:i.x,y:i.y,paused:!1,callbackScope:this,onComplete:function(t,e){i.destroy(),this.pet.on("animationcomplete",function(){this.pet.setFrame(0),this.uiReady()},this),this.pet.play("funnyfaces"),this.updateStats(this.selectedItem.customStats)}})}createHud(){this.healthText=this.add.text(20,20,"Health: ",{font:"24px Arial",fill:"#ffffff"}),this.funText=this.add.text(170,20,"Fun: ",{font:"24px Arial",fill:"#ffffff"})}refreshHud(){this.healthText.setText("Health: "+this.stats.health),this.funText.setText("Fun: "+this.stats.fun)}updateStats(t){let e=!1;for(let s in t)t.hasOwnProperty(s)&&(this.stats[s]+=t[s],this.stats[s]<0&&(e=!0,this.stats[s]=0));this.refreshHud(),e&&this.gameOver()}gameOver(){this.uiBlocked=!0,this.pet.setFrame(4),this.time.addEvent({delay:2e3,repeat:0,callback:()=>{this.scene.start("homeScene")}})}}const d=[];for(let t in i)d.push(i[t]);const l={type:Phaser.AUTO,backgroundColor:0,scale:{mode:Phaser.Scale.ENVELOP,parent:"app",autoCenter:Phaser.Scale.CENTER_BOTH,width:360,height:640,title:"虚拟宠物",pixelArt:!1,min:{width:360,height:640},max:{width:360,height:640}},scene:d};window.game=new Phaser.Game(l)}]);